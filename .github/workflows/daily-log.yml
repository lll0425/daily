name: Discipline - The Key to Success

on:
  push:
    branches:
      - main

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Git
        run: |
          git config --global user.name "lll0425"
          git config --global user.email "willy791124@gmail.com"

      - name: Create or Update Daily Log
        run:
           |
          export TZ="Asia/Taipei"
          mkdir -p $GITHUB_WORKSPACE/daily
          FILENAME="$GITHUB_WORKSPACE/daily/$(date +'%Y-%m-%d').md"
          echo "# 日期: $(date +'%Y-%m-%d')" > $FILENAME
          echo "## 今日任務:" >> $FILENAME
          echo "- [ ] 任務 1: 挑人體工學椅" >> $FILENAME
          echo "  > 註解: 目標價位 NT5000-8000 ，腰部支撐不要太凸還有頭部在90度需要靠助，躺下去有被扶起來的感覺。" >> $FILENAME
          echo "- [ ] 任務 2: leetcode 一題" >> $FILENAME
          echo "  > 註解: 今天挑選 medium 難度的題目" >> $FILENAME
          echo "- [ ] 任務 3: 論文找三句心得" >> $FILENAME
          echo "  > 註解: Membership_Inference_Attacks_Against_Machine_Learning_Models，記錄三個重要觀點。" >> $FILENAME
          echo "更新時間: $(date '+%H:%M:%S')" >> $FILENAME

      - name: Pull latest changes
        run: |
          git pull origin main --allow-unrelated-histories

      - name: Commit and Push Changes
        run: |
          git add .
          git commit -m "Auto backup $(date +'%Y-%m-%d')"
          git push https://github.com/lll0425/daily.git HEAD:main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
